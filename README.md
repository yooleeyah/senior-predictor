# Определение возрастной категории (ML-Модель + Сервер + Клиент) 

## Обзор проекта
Этот проект демонстрирует полный цикл разработки решения на основе машинного обучения: от обучения модели предсказания возрастной категории человека до базовой реализации её развертывания через REST API и взаимодействия с ней через клиент.
Проект включает в себя:
* Обучение ML-модели (model_training.ipynb).
* Простой API-сервер для инференса (simple_server.ipynb).
* Простой клиент для взаимодействия с сервером (simple_client.ipynb).

## Постановка задачи
Проект направлен на разработку системы, способной определять людей старшей возрастной категории (65+ лет). 
Основная цель проекта - создать точную модель классификации и продемонстрировать её интеграцию в простое клиент-серверное приложение для демонстрации возможности развертывания ML-моделей.

## Набор данных
Для этого проекта использовался поднабор данных из Национального исследования здоровья и питания 2013-2014 (NHANES), проводимого Центром по контролю и профилактике заболеваний (CDC). Набор данных содержит медицинские и демографические показатели респондентов из США.

Характеристики набора:
* Количество наблюдений: 6287
* Количество признаков: 7 (включая физиологические измерения, образ жизни и биохимические маркеры)
* Целевая переменная: age_group (возрастная группа респондента: "senior" или "non-senior"). Респонденты 65 лет и старше помечены как "senior", остальные - как "non-senior".
* Признаки:
  * RIAGENDR: Пол респондента.
  * PAQ605: Занимается ли респондент умеренными или интенсивными видами спорта, фитнесом или рекреационной деятельностью в обычную неделю.
  * BMXBMI: Индекс массы тела (ИМТ) респондента.
  * LBXGLU: Уровень глюкозы в крови респондента после голодания.
  * DIQ010: Является ли респондент диабетиком.
  * LBXGLT: Оральный тест на толерантность к глюкозе.
  * LBXIN: Уровень инсулина в крови респондента.

Источник: [Оригинальный полный набор данных NHANES 2013-2014](https://wwwn.cdc.gov/nchs/nhanes/search/DataPage.aspx?Component=Questionnaire&CycleBeginYear=2013)

## Компоненты проекта:
1. Обучение ML-модели (model_training.ipynb) - подготовка данных, обучение и оценка модели классификации:
    * Подготовка данных: приведение типов, борьба с дисбалансом классов, разделение на обучающую и тестовую выборки, масштабирование и кодирование категориальных переменных.
    * Выбор модели: был использован алгоритм Random Forest.
    * Оценка: использовались метрики Precision, Recall, F1-score.
    * Сохранение модели: обученная модель была сериализована и сохранена с помощью библиотеки dill в файл pipeline.dill для использования сервером.
2. Простой API-сервер (simple_server.ipynb) - предоставление доступа к обученной ML-модели через HTTP-запросы. Этот ноутбук представляет собой простой REST API-сервер, который загружает обученную модель и предоставляет эндпоинт для получения предсказаний. Сервер реализован в формате .ipynb для упрощения демонстрации.
3. Простой клиент (simple_client.ipynb) - взаимодействие с API-сервером для получения предсказаний. Этот ноутбук содержит клиентский код, который формирует запрос с данными пользователя, отправляет его на сервер API и выводит полученное предсказание.

## Используемые технологии:
* ЯП: Python
* Библиотеки: pandas, numpy, scikit-learn, flask, requests, dill, imbalanced-learn
* Веб-фреймворк: Flask 
* HTTP-запросы: requests

## Как запустить проект:
1. Клонируйте репозиторий: bash git clone https://github.com/yooleeyah/senior-predictor.git cd senior-predictor
2. Создайте и активируйте виртуальное окружение (рекомендуется): 
    * bash python -m venv venv source venv/bin/activate # macOS/Linux
    * .\venv\Scripts\activate # Windows
3. Установите зависимости: bash pip install -r requirements.txt
4. Запустите сервер:
    * Откройте simple_server.ipynb в Jupyter/Colab.
    * Выполните все ячейки. Сервер должен запуститься и слушать на указанном порту (http://127.0.0.1:5000).
5. Запустите клиент:
    * В новом окне или другой вкладке/сессии откройте simple_client.ipynb.
    * Выполните все ячейки. Клиент отправит запрос на запущенный сервер и выведет результат предсказания.
6. Модель (model_training.ipynb) можно запустить для повторного обучения модели, но это не обязательно для демонстрации работы сервера и клиента.

## Результаты и выводы:
Модель достигла f1-score = 0.84 на тестовом наборе, демонстрируя способность предсказывать возрастную группу с высокой эффективностью.
Проект демонстрирует базовый подход к развертыванию ML-модели, позволяя внешним приложениям взаимодействовать с ней для получения предсказаний.

## Дальнейшие шаги и улучшения:
* Контейнеризация сервера с Docker для упрощения развертывания.
* Разработка полноценного веб-интерфейса или мобильного приложения для клиента.
* Реализация более продвинутого API.
* Развертывание на облачной платформе.
* Использование других моделей и техник для повышения производительности.
